# =======================================================
# é€±æ¬¡3æšã‚¹ãƒ©ã‚¤ãƒ‰éª¨å­ãƒ†ãƒ³ãƒ—ãƒ¬
# =======================================================
weekly_slide_deck:
  purpose: "å¤–éƒ¨å…±æœ‰ãƒ»çµŒå–¶ãƒ¬ãƒ“ãƒ¥ãƒ¼å‘ã‘ã«ã€é€±æ¬¡ã®è¦ç‚¹ã‚’3æšã§å³æ™‚èª¬æ˜ã§ãã‚‹éª¨å­"
  export:
    file_naming:
      pattern: "docs/reports/weekly/slides/{YYYY}-W{WW}.md"
      alt_formats: ["pdf","pptx"]
    presenter: "Noctria ç‹ï¼ˆPMï¼‰"
    duration_minutes: 7
    # æ”¹å–„: ç”Ÿæˆã‚³ãƒãƒ³ãƒ‰ã¨å†ç¾ãƒ•ãƒ©ã‚°ã‚’è¿½åŠ 
    generate_cmd: "PYTHONPATH=. python scripts/generate_weekly_slides.py --week {YYYY}-W{WW} --out docs/reports/weekly/slides"
    reproducibility_footer: true

  design_guidelines:
    layout: "å„ã‚¹ãƒ©ã‚¤ãƒ‰ã¯è¦‹å‡ºã—â†’æ•°è¡¨/ç®‡æ¡æ›¸ãâ†’çµè«–ï¼ˆ1è¡Œï¼‰"
    bullets_max_per_slide: 5
    numbers_first: true
    font_scale_hint: "è¦‹å‡ºã—: 24â€“28 / æœ¬æ–‡: 14â€“16 / æ³¨é‡ˆ: 12"
    emoji_policy:
      allow: true
      guide:
        - "æˆæœ: âœ…"
        - "èª²é¡Œ/è­¦å ±: ğŸ””"
        - "æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: ğŸš€"
    # æ”¹å–„: æ©Ÿå¾®æƒ…å ±ã‚¬ãƒ¼ãƒ‰
    redaction:
      pii: true
      trading_secrets: true
      rule: "æ©Ÿå¯†ã¯ {REDACTED} ã«ç½®æ›ã€è©³ç´°ã¯åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§"

  variables:
    kpi_keys: ["brier_score","ece_calibration","adversarial_pass_rate"]
    baseline_label_format: "{win}r {stat}"
    date_range_label: "{from_date}ã€œ{to_date}ï¼ˆJSTï¼‰"
    # æ”¹å–„: SLO/Burnã®è¦ç´„ã‚’è¼‰ã›ã‚‹å¤‰æ•°
    slo_brief_vars:
      api_p95_burn_mid: "{burn_mid:.2f}"
      api_err_burn_mid: "{err_mid:.2f}"
      btft_fresh_burn_long: "{fresh_long:.2f}"

  # æ”¹å–„: ã‚¹ãƒ©ã‚¤ãƒ‰æœ¬ä½“å®šç¾©ï¼ˆ3æšï¼‰
  slides:
    - id: "s1_kpi_overview"
      title: "Slide 1 â€” KPI Overviewï¼ˆ{year}-W{week} / {date_range_label}ï¼‰"
      body: |
        **çµè«–ï¼ˆ1è¡Œï¼‰**: {exec_kpi_conclusion_one_line}

        | metric | latest | baseline({baseline_label}) | Î” vs baseline | trend |
        |---|---:|---:|---:|:--:|
        | Brier | {brier_latest:.4f} | {brier_base_txt} | {brier_dev_signed} | {brier_trend_arrow} |
        | ECE   | {ece_latest:.4f}   | {ece_base_txt}   | {ece_dev_signed}   | {ece_trend_arrow}   |
        | Adv   | {adv_latest:.4f}   | {adv_base_txt}   | {adv_dev_signed}   | {adv_trend_arrow}   |

        - ğŸ”” è­¦å ±ã¾ã¨ã‚: {alerts_week_brief}
        - SLO/Burn: p95(mid) {burn_mid:.2f} / err(mid) {err_mid:.2f} / fresh(long) {fresh_long:.2f}
        - æ³¨ç›®ã‚¤ãƒ™ãƒ³ãƒˆ: {events_one_line}
        - æ‰€æ„Ÿ: {kpi_comment_short}
      presenter_notes:
        - "ãƒˆãƒ¬ãƒ³ãƒ‰çŸ¢å°ã¯é€£ç¶šæ€§ã‚’å¼·èª¿ï¼ˆâ¬†/â¬‡/â†’ï¼‰ã€‚Î”ã¯ç¬¦å·ä»˜ãã§èª¬æ˜ã€‚"
        - "SLO/Burnã¯ä¸€è¨€ã§æ–¹é‡ï¼ˆæ§˜å­è¦‹/æ˜¯æ­£ï¼‰ã‚’æ·»ãˆã‚‹ã€‚"

    - id: "s2_decisions_and_changes"
      title: "Slide 2 â€” Decisions & Changes"
      body: |
        **çµè«–ï¼ˆ1è¡Œï¼‰**: {exec_ops_conclusion_one_line}

        **Decisionsï¼ˆä¸»è¦3ä»¶ï¼‰**
        1) {decision_1_id}: {decision_1_brief}ï¼ˆæ ¹æ‹ : {decision_1_reason_short}ï¼‰â†’ çŠ¶æ…‹: {decision_1_status}
        2) {decision_2_id}: {decision_2_brief}ï¼ˆæ ¹æ‹ : {decision_2_reason_short}ï¼‰â†’ çŠ¶æ…‹: {decision_2_status}
        3) {decision_3_id}: {decision_3_brief}ï¼ˆæ ¹æ‹ : {decision_3_reason_short}ï¼‰â†’ çŠ¶æ…‹: {decision_3_status}

        **Change Draftsï¼ˆä»Šé€±ã®èµ·ç¥¨/æ›´æ–°ï¼‰**
        - æ–°è¦: {changes_open_count} / å®Œäº†: {changes_closed_count} / ä¿ç•™: {changes_onhold_count}
        - ãƒã‚¤ãƒ©ã‚¤ãƒˆ: {highlight_change_id_or_dash} â€” {highlight_change_one_line}

        **ãƒªã‚¹ã‚¯ & ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**
        - é‡å¤§ãƒªã‚¹ã‚¯: {top_risk_one_line}
        - ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: {escalation_actions_brief}
      presenter_notes:
        - "Ordersã¨æˆåŠŸæ¡ä»¶ã‚’å£é ­ã§å³ç­”ã§ãã‚‹ç²’åº¦ã«ã€‚"
        - "CRITICALã¯â€œä½•ã‚’/ã„ã¤ã¾ã§ã«/èª°ãŒâ€ã‚’æ˜è¨€ã€‚"

    - id: "s3_next_week_focus"
      title: "Slide 3 â€” Next Week Focus & Commitments"
      body: |
        **çµè«–ï¼ˆ1è¡Œï¼‰**: {exec_nextweek_conclusion_one_line}

        **Focusï¼ˆæœ€å¤§3ç‚¹ / SMARTï¼‰**
        1) {focus1} â€” æœŸæ—¥: {focus1_due} / æ‹…å½“: {focus1_owner} / æˆåŠŸæ¡ä»¶: {focus1_criteria}
        2) {focus2} â€” æœŸæ—¥: {focus2_due} / æ‹…å½“: {focus2_owner} / æˆåŠŸæ¡ä»¶: {focus2_criteria}
        3) {focus3} â€” æœŸæ—¥: {focus3_due} / æ‹…å½“: {focus3_owner} / æˆåŠŸæ¡ä»¶: {focus3_criteria}

        **ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ**
        - ğŸš€ å®Ÿè¡Œ: {commit_do_line}
        - ğŸ§ª æ¤œè¨¼: {commit_test_line}
        - ğŸ” ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ¡ä»¶: {commit_rollback_trigger_line}

        **å‚è€ƒãƒªãƒ³ã‚¯**
        - Weekly Report: {weekly_report_path}
        - Decisions: {decisions_dir_path}
        - Changes: {changes_dir_path}
      presenter_notes:
        - "â€œæ¬¡ã®ä¸€æ‰‹â€ã¯3ã¤ã«çµã‚‹ã€‚æœŸæ—¥/æ‹…å½“/é”æˆåŸºæº–ã‚’æ˜è¨˜ã€‚"
        - "ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ¡ä»¶ã¯äº‹å‰åˆæ„ã‚’å¼·èª¿ã€‚"

  # æ”¹å–„: Lint/å—å…¥ãƒã‚§ãƒƒã‚¯
  acceptance_checklist:
    - "å„ã‚¹ãƒ©ã‚¤ãƒ‰ã«ã€çµè«–ï¼ˆ1è¡Œï¼‰ã€ãŒã‚ã‚‹"
    - "KPIè¡¨: latest / baseline / Î” / trend ã‚’1æšã§èª¬æ˜ã§ãã‚‹"
    - "Decisionã¯æœ€å¤§3ä»¶ã€Changeã¯ãƒã‚¤ãƒ©ã‚¤ãƒˆ1ä»¶ã§è¦ç‚¹ãŒä¼ã‚ã‚‹"
    - "Next Week: 3ç‚¹ãƒ»æœŸæ—¥ãƒ»æ‹…å½“ãƒ»æˆåŠŸæ¡ä»¶ãŒSMARTã§è¨˜è¼‰"
    - "å†ç¾ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆgit_sha/data_snapshot_id ãªã©ï¼‰ãŒå…¥ã‚‹ï¼ˆexport.reproducibility_footer=trueï¼‰"
    - "æ©Ÿå¾®æƒ…å ±ã®è‡ªå‹•ãƒã‚¹ã‚­ãƒ³ã‚°ï¼ˆredaction.ruleï¼‰ã‚’é€šé"

  # æ”¹å–„: è‡ªå‹•åŒ–ãƒ•ãƒƒã‚¯ï¼ˆä½œæˆâ†’ãƒ¬ãƒ“ãƒ¥ãƒ¼â†’å…¬é–‹ï¼‰
  automation_hooks:
    pre_generate:
      - "scripts.kpi_quickpeek"
    post_generate:
      - "scripts.validate_weekly_slides --lint --redact"
      - "scripts.publish_artifacts --path docs/reports/weekly/slides/{YYYY}-W{WW}.*"
    failure_handling:
      retry: { max: 2, backoff_minutes: [2,5] }
      escalate_to: ["human_pm","king"]
      annotate_weekly_report: true
