flowchart TD

  %% --- Planå±¤ï¼ˆè¨ˆç”»ãƒ»ç‰¹å¾´é‡ç”Ÿæˆï¼‰ ---
  subgraph Plan["ğŸ—ºï¸ PLANå±¤: å¸‚å ´åˆ†æãƒ»ç‰¹å¾´é‡ç”Ÿæˆ (src/plan_data/)"]
    COLLECTOR["collector.py<br>ğŸŸ© ãƒ‡ãƒ¼ã‚¿åé›†"]
    FEATURES["features.py<br>ğŸŸ¦ ãƒ†ã‚¯ãƒ»ãƒã‚¯ãƒ­ç‰¹å¾´é‡ç”Ÿæˆ"]
    STATISTICS["statistics.py<br>ğŸŸª KPIé›†è¨ˆ/çµ±è¨ˆ"]
    ANALYZER["analyzer.py<br>ğŸŸ§ è¦å› æŠ½å‡ºãƒ»è‡ªç„¶è¨€èªèª¬æ˜"]
    PLAN_WF["run_pdca_plan_workflow.py<br>ğŸŸ« PDCA Planãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼"]
    DF_OUT["å‡ºåŠ›: <b>ç‰¹å¾´é‡DataFrame</b>"]
    COLLECTOR --> FEATURES
    FEATURES --> STATISTICS
    FEATURES --> ANALYZER
    ANALYZER --> PLAN_WF
    STATISTICS --> PLAN_WF
    PLAN_WF --> DF_OUT
  end

  %% --- è‡£ä¸‹AIï¼ˆä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰ ---
  subgraph Vassals["ğŸ¤– è‡£ä¸‹AIï¼ˆä¸»è¦AI/ãƒªã‚¹ã‚¯è¨ˆç®—å«ã‚€ï¼‰"]
    AURUS["aurus_singularis.py<br>MLå¸‚å ´åˆ†æ"]
    LEVIA["levia_tempest.py<br>ã‚¹ã‚­ãƒ£ãƒ«ãƒ”ãƒ³ã‚°"]
    NOCTUS["noctus_sentinella.py<br>ãƒªã‚¹ã‚¯è¨ˆç®—/ãƒ­ãƒƒãƒˆè¨ˆç®—"]
    PROMETHEUS["prometheus_oracle.py<br>æœªæ¥äºˆæ¸¬"]
    HERMES["hermes_cognitor.py<br>LLMèª¬æ˜"]
    VERITAS["veritas_machina.py<br>æˆ¦ç•¥è©•ä¾¡ç”Ÿæˆ"]
  end

  %% --- ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ ---
  DF_OUT -- "dict/DFã§å…¥åŠ›" --> AURUS
  DF_OUT --> LEVIA
  DF_OUT --> NOCTUS
  DF_OUT --> PROMETHEUS
  DF_OUT --> VERITAS
  ANALYZER -- "è¦å› dict" --> HERMES

  %% --- ç‹ï¼ˆNoctriaï¼‰ ---
  subgraph King["ğŸ‘‘ Noctriaï¼ˆä¸­å¤®çµ±æ²»AIï¼‰"]
    KING["king_noctria.py<br>PDCAçµ±æ‹¬"]
  end

  AURUS -- "signal" --> KING
  LEVIA -- "signal" --> KING
  NOCTUS -- "ãƒªã‚¹ã‚¯åˆ¤å®š/lotè¨ˆç®—" --> KING
  PROMETHEUS -- "äºˆæ¸¬" --> KING
  HERMES -- "è¦ç´„" --> KING
  VERITAS -- "æˆ¦ç•¥è©•ä¾¡" --> KING

  %% --- Doå±¤ï¼ˆorder_executionï¼‰ã¸ã®å—ã‘æ¸¡ã— ---
  KING -- "å…¬å¼ç™ºæ³¨: issue_order_safely() <br>ï¼ˆNoctusè¨ˆç®—æ¸ˆlot/ãƒªã‚¹ã‚¯å€¤ã‚’å—ã‘å–ã‚‹ï¼‰" --> DOORDER[/"order_execution.py<br>MT5ç™ºæ³¨"/]

  %% --- ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ ---
  style COLLECTOR fill:#2176ae,color:#fff
  style FEATURES fill:#2a9d8f,color:#fff
  style STATISTICS fill:#6649b8,color:#fff
  style ANALYZER fill:#e68653,color:#fff
  style PLAN_WF fill:#8367c7,color:#fff
  style DF_OUT fill:#1d3557,color:#fff

  style AURUS fill:#2980b9,color:#fff
  style LEVIA fill:#e89c4d,color:#111
  style NOCTUS fill:#574f7d,color:#fff
  style PROMETHEUS fill:#512b81,color:#fff
  style HERMES fill:#5fa8d3,color:#111
  style VERITAS fill:#52b788,color:#fff

  style KING fill:#FFD700,color:#2d2d2d,stroke:#222,stroke-width:3px
  style DOORDER fill:#222,color:#fff,stroke:#FFD700,stroke-width:2px

  style Plan stroke:#aaa,stroke-width:2px
  style Vassals stroke:#aaa,stroke-width:2px
  style King stroke:#bca136,stroke-width:2px
