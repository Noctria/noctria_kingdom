flowchart TD
  %% --- パス・ロガー基盤 ---
  subgraph core
    path[path_config.py]
    logger[logger.py]
    data_loader[data_loader.py]
    king[king_noctria.py]
  end

  %% --- AI/戦略モジュール ---
  subgraph veritas
    veritas_eval[evaluate_veritas.py]
    veritas_gen[veritas_generate_strategy.py]
    strategy_gen[strategy_generator.py]
    machina[veritas_machina.py]
    simple_model[models/ml_model/simple_model.py]
  end
  subgraph strategies
    aurus[aurus_singularis.py]
    levia[levia_tempest.py]
    noctus[noctus_sentinella.py]
    prometheus[prometheus_oracle.py]
    hermes[hermes_cognitor.py]
  end
  subgraph plan
    collector[plan_data/collector.py]
    statistics[plan_data/statistics.py]
    features[plan_data/features.py]
  end

  %% --- DAG/ワークフロー ---
  subgraph dag
    aurus_dag[aurus_strategy_dag.py]
    levia_dag[levia_strategy_dag.py]
    noctus_dag[noctus_strategy_dag.py]
    prometheus_dag[prometheus_strategy_dag.py]
    hermes_dag[hermes_strategy_dag.py]
    veritas_push_dag[veritas_push_dag.py]
    king_dag[noctria_kingdom_dag.py]
  end

  %% --- GUI/API ---
  subgraph gui
    king_routes[noctria_gui/routes/king_routes.py]
  end

  %% --- 依存関係 ---
  path --> logger
  logger -->|setup_logger| strategy_gen
  logger -->|setup_logger| veritas_gen
  logger -->|setup_logger| machina
  logger -->|setup_logger| king
  logger -->|setup_logger| veritas_eval

  king -->|臣下呼び出し| aurus
  king -->|臣下呼び出し| levia
  king -->|臣下呼び出し| noctus
  king -->|臣下呼び出し| prometheus
  king -->|臣下呼び出し| hermes
  king -->|ML評価| machina
  king -->|外部API| data_loader

  veritas_gen -->|パス利用| path
  veritas_eval -->|パス利用| path

  aurus_dag -->|strategy import| aurus
  levia_dag -->|strategy import| levia
  noctus_dag -->|strategy import| noctus
  prometheus_dag -->|strategy import| prometheus
  hermes_dag -->|strategy import| hermes

  king_dag --> king
  king_routes --> king

  collector --> statistics
  statistics --> features

  plan -->|参照| collector
  plan -->|参照| statistics

  king -->|DAG/APIトリガー| king_dag
  king_routes --> king

  strategy_gen --> simple_model
  machina --> simple_model
