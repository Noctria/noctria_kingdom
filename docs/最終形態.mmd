flowchart TD

%% === 統治AI・五臣クラスタ ===
    KN[src/core/king_noctria.py<br>KingNoctria]
    VRM[src/veritas/veritas_machina.py<br>VeritasMachina]
    PRO[src/strategies/prometheus_oracle.py<br>PrometheusOracle]
    ARS[src/strategies/aurus_singularis.py<br>AurusSingularis]
    LVA[src/strategies/levia_tempest.py<br>LeviaTempest]
    NOC[src/strategies/noctus_sentinella.py<br>NoctusSentinella]
    HMS[src/strategies/hermes_cognitor.py<br>HermesCognitorStrategy]

%% === コア・設定・共通領域 ===
    PCFG[src/core/path_config.py<br>path_config]
    RSKM[src/core/risk_manager.py<br>RiskManager]

%% === 戦略自動生成・評価・モデルクラスタ ===
    VGEN[src/veritas/veritas_generate_strategy.py<br>veritas_generate_strategy]
    VEVAL[src/veritas/evaluate_veritas.py<br>evaluate_veritas]
    VSG[src/veritas/strategy_generator.py<br>strategy_generator]
    SMM[src/veritas/models/ml_model/simple_model.py<br>SimpleModel]

%% === プラン統計クラスタ ===
    PLCOL[src/plan_data/collector.py<br>PlanDataCollector]
    PLST[src/plan_data/statistics.py<br>PlanStatistics]
    PLFT[src/plan_data/features.py<br>FeatureEngineer]

%% === Airflow DAGクラスタ ===
    DAG_AUR[airflow_docker/dags/aurus_strategy_dag.py<br>AurusStrategyDAG]
    DAG_HMS[airflow_docker/dags/hermes_strategy_dag.py<br>HermesStrategyDAG]

%% === 呼び出し・依存関係 ===
    %% Kingと五臣
    KN -- "呼び出し" --> VRM
    KN -- "呼び出し" --> PRO
    KN -- "呼び出し" --> ARS
    KN -- "呼び出し" --> LVA
    KN -- "呼び出し" --> NOC
    KN -- "呼び出し" --> HMS

    %% 五臣の依存
    VRM -- "戦略生成/評価スクリプト" --> VGEN
    VRM -- "戦略生成/評価スクリプト" --> VEVAL

    VRM -- "モデル/戦略保存" --> VSG
    VSG -- "モデル利用" --> SMM

    NOC -- "リスク評価" --> RSKM

    ARS -- "パス・モデル依存" --> PCFG
    PRO -- "パス・モデル依存" --> PCFG
    VRM -- "パス依存" --> PCFG
    VGEN -- "パス依存" --> PCFG
    VEVAL -- "パス依存" --> PCFG
    VSG -- "パス依存" --> PCFG
    LVA -- "パス依存" --> PCFG
    NOC -- "パス依存" --> PCFG
    HMS -- "パス依存" --> PCFG

    NOC -- "リスク計算" --> RSKM

    %% PlanData/統計
    PLST -- "データ収集" --> PLCOL
    PLFT -- "特徴量追加" --> PLCOL

    %% Airflow
    DAG_AUR -- "import" --> ARS
    DAG_HMS -- "import" --> HMS

%% === コメント ===
    %% 他DAG/PDCA/GUI系は未接続
