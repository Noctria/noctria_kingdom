#!/bin/bash
# ==============================================
# ğŸ”§ Airflow åˆæœŸåŒ– & ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# - airflow db upgrade ã‚’å®Ÿè¡Œã—ã¦åˆæœŸåŒ–
# - admin/admin ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€è‡ªå‹•ä½œæˆ
# - ãã®å¾Œã€æœ¬æ¥ã® Airflow ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œï¼ˆwebserver ç­‰ï¼‰
# ==============================================

set -e  # ã‚¨ãƒ©ãƒ¼æ™‚å³çµ‚äº†

echo "ğŸ”§ Step 1: Airflow ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–"
airflow db upgrade

echo "ğŸ‘¤ Step 2: ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã‚’ç¢ºèªä¸­..."
python /opt/airflow/tools/create_admin_user.py

echo "ğŸš€ Step 3: Airflow ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹• â†’ airflow $@"
exec airflow "$@"
