<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“Š æˆ¦ç•¥æ¯”è¼ƒã‚°ãƒ©ãƒ•</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <h1>ğŸ“Š è¤‡æ•°æˆ¦ç•¥ã®è©•ä¾¡æ¯”è¼ƒ</h1>
  <canvas id="comparisonChart" width="800" height="400"></canvas>
  <script>
    const strategies = {{ strategies | tojson }};
    
    const labels = strategies.map(s => s.strategy || s.json_name);
    const winRates = strategies.map(s => s.win_rate || 0);
    const drawdowns = strategies.map(s => s.max_drawdown || 0);
    const trades = strategies.map(s => s.num_trades || 0);

    const data = {
      labels: labels,
      datasets: [
        {
          label: 'å‹ç‡ï¼ˆ%ï¼‰',
          data: winRates,
          borderColor: 'blue',
          backgroundColor: 'lightblue',
          yAxisID: 'y',
        },
        {
          label: 'æœ€å¤§DDï¼ˆ%ï¼‰',
          data: drawdowns,
          borderColor: 'red',
          backgroundColor: 'salmon',
          yAxisID: 'y1',
        },
        {
          label: 'å–å¼•å›æ•°',
          data: trades,
          borderColor: 'green',
          backgroundColor: 'lightgreen',
          yAxisID: 'y2',
        }
      ]
    };

    const config = {
      type: 'bar',
      data: data,
      options: {
        responsive: true,
        interaction: {
          mode: 'index',
          intersect: false,
        },
        stacked: false,
        plugins: {
          title: {
            display: true,
            text: 'æˆ¦ç•¥åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ'
          }
        },
        scales: {
          y: {
            type: 'linear',
            display: true,
            position: 'left',
            title: { display: true, text: 'å‹ç‡ï¼ˆ%ï¼‰' }
          },
          y1: {
            type: 'linear',
            display: true,
            position: 'right',
            grid: { drawOnChartArea: false },
            title: { display: true, text: 'æœ€å¤§DDï¼ˆ%ï¼‰' }
          },
          y2: {
            type: 'linear',
            display: false,
            position: 'right',
            title: { display: true, text: 'å–å¼•å›æ•°' }
          }
        }
      },
    };

    new Chart(document.getElementById('comparisonChart'), config);
  </script>
  <a href="/strategies/overview">â† æˆ¦ç•¥ä¸€è¦§ã«æˆ»ã‚‹</a>
</body>
</html>
