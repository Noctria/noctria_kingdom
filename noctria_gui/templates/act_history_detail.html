{% extends "base_hud.html" %}

{% block title %}üìÑ Strategy Detail - Noctria Kingdom HUD{% endblock %}

{% block header_icon %}<i class="fas fa-file-invoice"></i>{% endblock %}
{% block header_title %}STRATEGY DETAIL{% endblock %}
{% block header_nav_href %}/act-history{% endblock %}
{% block header_nav_text %}BACK TO LOGS{% endblock %}

{% block content %}
<!-- Main Detail Panel -->
<main class="hud-panel detail-panel">
    <h2 class="panel-title">STRATEGY: {{ log.strategy }}</h2>

    <div class="detail-grid">
        <!-- Left Column -->
        <div class="detail-info">
            <dl class="hud-dl">
                <div>
                    <dt>Symbol</dt>
                    <dd>{{ log.symbol }}</dd>
                </div>
                <div>
                    <dt>Promoted At</dt>
                    <dd>{{ log.promoted_at or log.timestamp }}</dd>
                </div>
                <div>
                    <dt>Win Rate</dt>
                    <dd class="text-green">
                        {{ '%.2f'|format(log.win_rate) if log.win_rate is not none else '-' }}%
                    </dd>
                </div>
                <div>
                    <dt>Max Drawdown</dt>
                    <dd class="text-magenta">
                        {{ '%.2f'|format(log.max_drawdown) if log.max_drawdown is not none else '-' }}%
                    </dd>
                </div>
                <div>
                    <dt>Score</dt>
                    <dd class="text-cyan">
                        {{ '%.2f'|format(log.score_mean) if log.score_mean is not none else '-' }}
                    </dd>
                </div>
                <div>
                    <dt>Pushed</dt>
                    <dd>{{ '‚úÖ Pushed' if log.pushed else '‚ùå Not Pushed' }}</dd>
                </div>
                <div>
                    <dt>Filename</dt>
                    <dd>{{ log.filename }}</dd>
                </div>
                <div>
                    <dt>Tags</dt>
                    <dd>
                        {% if log.tags %}
                            {% for t in log.tags %}
                                <span class="hud-tag">{{ t }}</span>
                            {% endfor %}
                        {% else %}<span>-</span>{% endif %}
                    </dd>
                </div>
            </dl>
        </div>

        <!-- Right Column -->
        <div class="detail-actions">
            <h3 class="actions-title">OPERATIONS</h3>
            <form method="post" action="/act-history/repush">
                <input type="hidden" name="strategy_name" value="{{ log.strategy }}">
                <button class="hud-btn" type="submit">
                    <i class="fas fa-redo"></i> ÂÜçPushÂèØ„Å´„Åô„Çã
                </button>
            </form>
            <form method="post" action="/act-history/reevaluate">
                <input type="hidden" name="strategy_name" value="{{ log.strategy }}">
                <button class="hud-btn" type="submit">
                    <i class="fas fa-cogs"></i> ÂÜçË©ï‰æ°„Åô„Çã
                </button>
            </form>
        </div>
    </div>
</main>

<!-- Raw JSON Section -->
<section class="hud-panel log-content-panel">
    <h2 class="panel-title"><i class="fas fa-code"></i> RAW LOG DATA</h2>
    <pre class="log-json">{{ log.json_text }}</pre>
</section>
{% endblock %}
