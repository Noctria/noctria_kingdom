{% extends "base.html" %}

{% block title %}📊 タグ別スコアボード - Noctria Kingdom{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-4">📊 タグ別統合スコアボード</h2>

<!-- 🔽 ソート選択 -->
<form method="get" action="/statistics/scoreboard" class="mb-4">
  <label class="font-semibold mr-2">🔽 ソート項目:</label>
  <select name="sort" onchange="this.form.submit()" class="px-2 py-1 border rounded dark:bg-gray-800 dark:text-white">
    <option value="count" {% if sort_key == "count" %}selected{% endif %}>📦 件数（多い順）</option>
    <option value="avg_win" {% if sort_key == "avg_win" %}selected{% endif %}>⚔ 勝率（高い順）</option>
    <option value="avg_dd" {% if sort_key == "avg_dd" %}selected{% endif %}>📉 最大DD（大きい順）</option>
  </select>
</form>

<!-- 📋 タグ別スコア表 -->
<table class="min-w-full border-collapse bg-white dark:bg-gray-800 rounded shadow">
  <thead>
    <tr class="bg-gray-100 dark:bg-gray-700 text-left">
      <th class="px-4 py-2 border-b">🏷 タグ名</th>
      <th class="px-4 py-2 border-b">📦 件数</th>
      <th class="px-4 py-2 border-b">⚔ 平均勝率（%）</th>
      <th class="px-4 py-2 border-b">📉 最大DD（%）</th>
    </tr>
  </thead>
  <tbody>
    {% for tag, stats in tag_stats %}
    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
      <td class="px-4 py-2 border-b font-medium">{{ tag }}</td>
      <td class="px-4 py-2 border-b">{{ stats.count }}</td>
      <td class="px-4 py-2 border-b">{{ "%.1f"|format(stats.avg_win) if stats.avg_win is not none else "-" }}</td>
      <td class="px-4 py-2 border-b">{{ "%.1f"|format(stats.avg_dd) if stats.avg_dd is not none else "-" }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- 🔽 CSVエクスポート（オプション） -->
<!--
<div class="mt-4">
  <a href="/statistics/scoreboard/export?sort={{ sort_key }}" class="inline-block px-3 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">
    📁 CSV出力
  </a>
</div>
-->

{% endblock %}
