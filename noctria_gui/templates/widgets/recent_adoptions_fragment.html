<!-- noctria_gui/templates/widgets/recent_adoptions_fragment.html -->
<div class="widget-panel">
  {% if title %}<h2 class="widget-title" style="margin:0 0 .5rem 0">{{ title }}</h2>{% endif %}
  <div class="cards-grid" style="display:grid; gap:.75rem; grid-template-columns: repeat({{ cols }}, minmax(0,1fr));">
    {% for c in items %}
      {% set d = c.decision %}
      <div class="card">
        <div class="card-header">
          <code>{{ c.tag }}</code>
          <span class="badge" title="annotated?">{{ c.annotated }}</span>
        </div>
        <div class="card-body">
          <ul class="kv">
            <li><span>tag date</span><code>{{ c.date }}</code></li>
            <li><span>sha</span><code>{{ c.sha }}</code></li>
            {% if d and d.decision_id %}
              <li><span>decision</span><a href="/decisions/{{ d.decision_id }}"><code>{{ d.decision_id }}</code></a></li>
              <li><span>phase</span>{{ d.phase }}</li>
              <li><span>registry ts</span><code>{{ d.ts_utc }}</code></li>
            {% else %}
              <li><span>decision</span><span class="muted">—</span></li>
            {% endif %}
          </ul>
        </div>
        <div class="card-actions">
          <a class="btn" href="/tags/{{ c.tag }}">詳しく</a>
        </div>
      </div>
    {% else %}
      <div class="muted">表示するカードがありません。</div>
    {% endfor %}
  </div>
  <div class="widget-actions" style="margin-top:.5rem">
    <a class="btn" href="/adoptions?pattern={{ pattern }}&limit={{ limit }}">🗂 一覧</a>
    <a class="btn" href="/tags">🏷 タグ</a>
    <a class="btn" href="/pdca/recent-adoptions?pattern={{ pattern }}&limit={{ limit }}">🔎 拡大表示</a>
  </div>
</div>
