{% extends "base_hud.html" %}

{% block title %}ğŸ“Š çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}
{% block header_icon %}<i class="fas fa-database"></i>{% endblock %}
{% block header_title %}STRATEGY STATISTICS{% endblock %}
{% block header_nav_href %}/statistics{% endblock %}
{% block header_nav_text %}çµ±è¨ˆä¸€è¦§{% endblock %}

{% block content %}
<section class="hud-panel metrics">
  <h2 class="panel-title">çµ±è¨ˆæ¦‚è¦</h2>
  <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
    <div class="metric-item">
      <h3><i class="fas fa-chart-line"></i> å¹³å‡å‹ç‡</h3>
      <p class="metric-value text-green">{{ stats.avg_win_rate | round(2) }}%</p>
    </div>
    <div class="metric-item">
      <h3><i class="fas fa-bolt"></i> å¹³å‡DD</h3>
      <p class="metric-value text-red">{{ stats.avg_drawdown | round(2) }}%</p>
    </div>
    <div class="metric-item">
      <h3><i class="fas fa-layer-group"></i> æˆ¦ç•¥æ•°</h3>
      <p class="metric-value">{{ stats.strategy_count }}</p>
    </div>
  </div>
</section>

<section class="hud-panel">
  <h2 class="panel-title">ã‚¿ã‚°åˆ¥åˆ†å¸ƒ</h2>
  <canvas id="tagPieChart" width="400" height="300"></canvas>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('tagPieChart').getContext('2d');
  const tagPieChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: {{ stats.tag_distribution.keys() | list | tojson }},
      datasets: [{
        label: 'æˆ¦ç•¥æ•°',
        data: {{ stats.tag_distribution.values() | list | tojson }},
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'right' }
      }
    }
  });
</script>
{% endblock %}
