{% extends "base_hud.html" %}
{% block title %}🏅 タグ別戦略ランキング{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">🏅 タグ別戦略ランキング</h1>

<!-- 🔍 フィルター -->
<form method="get" class="flex flex-wrap gap-4 items-center mb-6">
  <label class="flex items-center gap-2">
    <span>From:</span>
    <input type="date" name="from" value="{{ filter.from }}" class="input input-bordered">
  </label>
  <label class="flex items-center gap-2">
    <span>To:</span>
    <input type="date" name="to" value="{{ filter.to }}" class="input input-bordered">
  </label>
  <label class="flex items-center gap-2">
    <span>Tag:</span>
    <input type="text" name="tag" value="{{ filter.tag }}" class="input input-bordered">
  </label>
  <button type="submit" class="btn btn-primary">適用</button>
</form>

<!-- 📊 ランキング表示 -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
  <div class="card bg-base-100 shadow p-4">
    <h2 class="text-lg font-semibold border-b pb-1 mb-2">📈 勝率ランキング</h2>
    <ol class="list-decimal ml-5 space-y-1">
      {% for item in ranking_win %}
        <li>{{ item.tag }}（{{ item.avg_win }}%）</li>
      {% else %}
        <li>該当データなし</li>
      {% endfor %}
    </ol>
  </div>

  <div class="card bg-base-100 shadow p-4">
    <h2 class="text-lg font-semibold border-b pb-1 mb-2">🧘 安定性ランキング（低DD）</h2>
    <ol class="list-decimal ml-5 space-y-1">
      {% for item in ranking_dd %}
        <li>{{ item.tag }}（{{ item.avg_dd }}%）</li>
      {% else %}
        <li>該当データなし</li>
      {% endfor %}
    </ol>
  </div>

  <div class="card bg-base-100 shadow p-4">
    <h2 class="text-lg font-semibold border-b pb-1 mb-2">📊 件数ランキング</h2>
    <ol class="list-decimal ml-5 space-y-1">
      {% for item in ranking_count %}
        <li>{{ item.tag }}（{{ item.count }}件）</li>
      {% else %}
        <li>該当データなし</li>
      {% endfor %}
    </ol>
  </div>
</div>

<!-- 📤 CSVエクスポート -->
<div class="mt-6">
  <a class="btn btn-secondary" href="/statistics/ranking/export?from={{ filter.from }}&to={{ filter.to }}&tag={{ filter.tag }}">
    📤 CSVエクスポート
  </a>
</div>
{% endblock %}
