<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ“¤ Pushå±¥æ­´ - Noctria Kingdom</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <h1>ğŸ“¤ Veritas Pushå±¥æ­´ä¸€è¦§</h1>

  <!-- ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼UI -->
  <form method="get" action="/push-history" class="filter card">
    <label>
      æˆ¦ç•¥å
      <input type="text" name="strategy" value="{{ filters.strategy }}">
    </label>
    <label>
      ã‚¿ã‚°
      <input type="text" name="tag" value="{{ filters.tag }}">
    </label>
    <label>
      é–‹å§‹æ—¥
      <input type="date" name="start_date" value="{{ filters.start_date }}">
    </label>
    <label>
      çµ‚äº†æ—¥
      <input type="date" name="end_date" value="{{ filters.end_date }}">
    </label>
    <label>
      ä¸¦ã³é †
      <select name="sort">
        <option value="desc" {% if filters.sort == 'desc' %}selected{% endif %}>æ–°ã—ã„é †</option>
        <option value="asc" {% if filters.sort == 'asc' %}selected{% endif %}>å¤ã„é †</option>
      </select>
    </label>
    <button type="submit" class="btn">ğŸ” æ¤œç´¢</button>
    <a class="btn"
       href="/push-history/export?strategy={{ filters.strategy }}&tag={{ filters.tag }}&start_date={{ filters.start_date }}&end_date={{ filters.end_date }}">
      ğŸ“¤ CSVå‡ºåŠ›
    </a>
  </form>

  <!-- ğŸ“‹ Pushãƒ­ã‚°ä¸€è¦§ -->
  <table class="table">
    <thead>
      <tr>
        <th>æ—¥æ™‚</th>
        <th>æˆ¦ç•¥å</th>
        <th>ã‚¿ã‚°</th>
        <th>æ‹…å½“è€…</th>
        <th>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</th>
        <th>è©³ç´°</th>
      </tr>
    </thead>
    <tbody>
      {% for log in logs %}
      <tr>
        <td>{{ log.timestamp }}</td>
        <td>{{ log.strategy }}</td>
        <td>{{ log.tag or "-" }}</td>
        <td>{{ log.pushed_by or "-" }}</td>
        <td>{{ log.message or "-" }}</td>
        <td>
          <a href="/push-history/detail?timestamp={{ log.timestamp }}" class="btn">ğŸ” è©³ç´°</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- ğŸ“„ ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
  {% if total_pages > 1 %}
  <div style="margin-top: 1rem;">
    {% for p in range(1, total_pages + 1) %}
      {% if p == current_page %}
        <strong style="margin: 0 4px;">[{{ p }}]</strong>
      {% else %}
        <a href="?page={{ p }}&strategy={{ filters.strategy }}&tag={{ filters.tag }}&start_date={{ filters.start_date }}&end_date={{ filters.end_date }}&sort={{ filters.sort }}" style="margin: 0 4px;">
          {{ p }}
        </a>
      {% endif %}
    {% endfor %}
  </div>
  {% endif %}
</body>
</html>
